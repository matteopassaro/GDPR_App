import { useState } from "react";

interface Props {
  onClick?: () => void;
}

const Vulnerability = ({ onClick }: Props) => {
  const [showList, setShowList] = useState(false);
  const [showOwaspList, setShowOwaspList] = useState(false);
  const [showCweList, setShowCweList] = useState(false);

  const handleButtonClick = () => {
    setShowList(!showList);

    if (showOwaspList === true || showCweList === true) {
      setShowCweList(false);
      setShowOwaspList(false);
    }
    if (onClick) {
      onClick();
    }
  };

  const handleOwaspButtonClick = () => {
    setShowOwaspList(!showOwaspList);
    if (showCweList === true) {
      setShowCweList(!showCweList);
    }
    if (onClick) {
      onClick();
    }
  };

  const handleCweButtonClick = () => {
    setShowCweList(!showCweList);
    if (showOwaspList === true) {
      setShowOwaspList(!showOwaspList);
    }
    if (onClick) {
      onClick();
    }
  };

  const OWASP = [
    "A01",
    "A02",
    "A03",
    "A04",
    "A05",
    "A06",
    "A07",
    "A08",
    "A09",
    "A10",
  ];

  const vulnerabilities = [
    "CWE-20",
    "CWE-22",
    "CWE-77",
    "CWE-78",
    "CWE-79",
    "CWE-89",
    "CWE-94",
    "CWE-269",
    "CWE-276",
    "CWE-287",
    "CWE-306",
    "CWE-434",
    "CWE-502",
    "CWE-798",
    "CWE-862",
    "CWE-863",
    "CWE-918",
  ];

  return (
    <>
      <button
        className="w-full py-2 px-4 bg-green-600 text-black rounded-full hover:bg-green-700"
        onClick={handleButtonClick}
      >
        Vulnerabilit√†
      </button>
      {showList && (
        <>
          <button
            className="w-24 py-2 px-2 bg-green-600 text-black rounded-full hover:bg-green-700"
            onClick={handleOwaspButtonClick}
          >
            OWASP
          </button>
          {showOwaspList && (
            <ul>
              {OWASP.map((item, index) => (
                <li
                  key={index}
                  className="mt-1 w-18 py-1 rounded-full px-4 text-black hover:bg-green-500 bg-green-400"
                >
                  {item}
                </li>
              ))}
            </ul>
          )}
          <button
            className="w-24 py-2 px-2 bg-green-600 text-black rounded-full hover:bg-green-700"
            onClick={handleCweButtonClick}
          >
            CWE
          </button>
          {showCweList && (
            <ul>
              {vulnerabilities.map((vulnerability, index) => (
                <li
                  className="mt-1 w-18 py-1 items-center rounded-full px-4 text-black hover:bg-green-500 bg-green-400"
                  key={index}
                >
                  {vulnerability}
                </li>
              ))}
            </ul>
          )}
        </>
      )}
    </>
  );
};

export default Vulnerability;
